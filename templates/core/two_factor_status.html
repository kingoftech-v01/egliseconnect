{% extends "base.html" %}
{% load i18n %}
{% block content %}
<div class="container-fluid">
    <div class="row page-titles">
        <div class="col-md-5 align-self-center">
            <h4 class="text-themecolor">{{ page_title }}</h4>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-danger text-white">
                    <h5 class="mb-0">{% trans "Sans 2FA" %} ({{ members_without_2fa.count }})</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>{% trans "Membre" %}</th>
                                    <th>{% trans "Email" %}</th>
                                    <th>{% trans "Date limite" %}</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for member in members_without_2fa %}
                                <tr>
                                    <td>{{ member.full_name }}</td>
                                    <td>{{ member.email }}</td>
                                    <td>
                                        {% if member.two_factor_deadline %}
                                            {{ member.two_factor_deadline|date:"d/m/Y" }}
                                            {% if member.is_2fa_overdue %}
                                                <span class="badge bg-danger">{% trans "Expiré" %}</span>
                                            {% endif %}
                                        {% else %}
                                            -
                                        {% endif %}
                                    </td>
                                </tr>
                                {% empty %}
                                <tr>
                                    <td colspan="3" class="text-center">{% trans "Tous les membres ont activé le 2FA!" %}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0">{% trans "Avec 2FA" %} ({{ members_with_2fa.count }})</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>{% trans "Membre" %}</th>
                                    <th>{% trans "Email" %}</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for member in members_with_2fa %}
                                <tr>
                                    <td>{{ member.full_name }}</td>
                                    <td>{{ member.email }}</td>
                                </tr>
                                {% empty %}
                                <tr>
                                    <td colspan="2" class="text-center">{% trans "Aucun membre avec 2FA." %}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
